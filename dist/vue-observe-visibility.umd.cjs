(function(o,c){typeof exports=="object"&&typeof module<"u"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(o=typeof globalThis<"u"?globalThis:o||self,c(o.VueObserveVisibility={}))})(this,function(o){"use strict";function c(t){let i;return typeof t=="function"?i={callback:t}:i=t,i}function O(t,i,n={}){let e,s,r;const u=(l,..._)=>{if(r=_,e&&l===s)return;let h=n.leading;typeof h=="function"&&(h=h(l,s)),(!e||l!==s)&&h&&t(l,...r),s=l,clearTimeout(e),e=setTimeout(()=>{t(l,...r),e=0},i)};return u._clear=()=>{clearTimeout(e),e=null},u}function b(t,i){if(t===i)return!0;if(typeof t=="object"){for(const n in t)if(!b(t[n],i[n]))return!1;return!0}return!1}class g{constructor(i,n,e){this.el=i,this.observer=null,this.frozen=!1,this.createObserver(n,e)}get threshold(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}createObserver(i,n){if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=c(i),this.callback=(e,s)=>{this.options.callback(e,s),e&&this.options.once&&(this.frozen=!0,this.destroyObserver())},this.callback&&this.options.throttle){const{leading:e}=this.options.throttleOptions||{};this.callback=O(this.callback,this.options.throttle,{leading:s=>e==="both"||e==="visible"&&s||e==="hidden"&&!s})}this.oldResult=void 0,this.observer=new IntersectionObserver(e=>{let s=e[0];if(e.length>1){const r=e.find(u=>u.isIntersecting);r&&(s=r)}if(this.callback){const r=s.isIntersecting&&s.intersectionRatio>=this.threshold;if(r===this.oldResult)return;this.oldResult=r,this.callback(r,s)}},this.options.intersection),n.context.$nextTick(()=>{this.observer&&this.observer.observe(this.el)})}}destroyObserver(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}}function a(t,{value:i},n){if(i)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{const e=new g(t,i,n);t._vue_visibilityState=e}}function k(t,{value:i,oldValue:n},e){if(b(i,n))return;const s=t._vue_visibilityState;if(!i){d(t);return}s?s.createObserver(i,e):a(t,{value:i},e)}function d(t){const i=t._vue_visibilityState;i&&(i.destroyObserver(),delete t._vue_visibilityState)}const p={bind:a,update:k,unbind:d};function v(t){t.directive("observe-visibility",p)}const y={version:VERSION,install:v};let f=null;typeof window<"u"?f=window.Vue:typeof global<"u"&&(f=global.Vue),f&&f.use(y),o.ObserveVisibility=p,o.default=y,o.install=v,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
